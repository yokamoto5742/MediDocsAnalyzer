# 医療文書管理アプリ

## 概要
この「医療文書管理アプリ」は、Papyrusから出力されたCSVデータを読み込み、指定したExcelファイルに効率的に転記するためのツールです。医療文書の書類受付リストを管理するために設計されており、特定の文書名や医師名を除外する機能も備えています。

## 機能
- CSVファイルの自動検出と読み込み
- 日付形式の自動変換
- 除外したい文書名や医師名の設定
- データをExcelに転記（重複チェック機能付き）
- Excelファイルの自動バックアップ
- 処理済みCSVファイルの自動管理
- UI設定のカスタマイズ（フォントサイズ、ウィンドウサイズ）
- 各種フォルダパスの設定

## 動作環境
- Windows OS
- Python 3.11以上
- 必要なライブラリ：PyQt6, polars, openpyxl, pyautogui, pywin32など

## インストール方法

### 前提条件
- Python 3.11以上がインストールされていること

### インストール手順
1. リポジトリをクローンまたはダウンロードします
2. 必要なライブラリをインストールします
   ```
   pip install -r requirements.txt
   ```

## 使い方

### アプリの起動
```
python main.py
```

### 基本操作
1. アプリを起動すると、メインウィンドウが表示されます
2. 「CSVファイル取り込み」ボタンをクリックして、最新のCSVファイルを処理します
3. 設定メニューから各種設定を行うことができます

### 設定項目
- **除外する文書名**: 転記しない文書の種類を設定
- **除外する医師名**: 転記しない医師名を設定
- **フォントとウインドウサイズ**: UIの表示設定
- **画面の座標表示**: 「共有」ボタンの座標を設定するためのツール
- **フォルダの場所**: 各種パスの設定
  - ダウンロードフォルダ: CSVファイルが保存されている場所
  - Excelファイルパス: 転記先のExcelファイル
  - バックアップフォルダ: バックアップファイルの保存先

## 特記事項

### CSVファイル命名規則
アプリは特定の命名規則に従ったCSVファイルのみを処理します。ファイル名は以下の形式である必要があります：
- フォーマット: `[3-4桁の数字]_[14桁の数字].csv`

### 共有ボタンの自動化
Excelファイルを開いた後、アプリは設定された座標に基づいて「共有」ボタンを自動的にクリックします。
この機能を使用するには、ButtonPosition設定で正確な座標を設定してください。

## トラブルシューティング

### 一般的な問題
- **CSVファイルが見つからない**: ダウンロードフォルダのパスが正しく設定されているか確認してください
- **Excelファイルを開けない**: ファイルが他のアプリケーションで開かれていないか確認してください
- **共有ボタンが機能しない**: 座標が正しく設定されているか確認してください

### エラーログ
エラーが発生した場合は、アプリケーションがエラーメッセージを表示します。また、コンソールに詳細なエラー情報が出力されます。

## 開発者向け情報

### プロジェクト構成
- **app_dialogs.py**: 各種設定ダイアログの実装
- **app_main_window.py**: メインウィンドウのUI実装
- **config_manager.py**: 設定ファイル管理クラス
- **main.py**: アプリケーションのエントリーポイント
- **service_coordinate_tracker.py**: 画面座標追跡ツール
- **service_csv_excel_transfer.py**: CSVからExcelへの転記処理のメイン処理
- **service_csv_processor.py**: CSVファイル処理のユーティリティ
- **service_excel_processor.py**: Excel処理のユーティリティ
- **service_file_manager.py**: ファイル管理ユーティリティ
- **version.py**: バージョン情報

### 拡張・カスタマイズ
新機能の追加や既存機能の修正を行う際は、以下のクラス構造を理解しておくと効率的です：
- **ConfigManager**: 設定情報の管理
- **MainWindow**: メインUIの制御
- **各種Dialog**: 設定ダイアログの実装
- **各種Service**: バックエンドの処理ロジック

## ライセンス
このアプリケーションの利用・改変・再配布については、LICENSEを確認してください。

## 連絡先
問題や質問がある場合は、アプリケーション管理者にお問い合わせください。